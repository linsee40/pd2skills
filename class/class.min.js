function Pointer(){if(!this instanceof Pointer){return new Pointer()}this.target=null}Pointer.fn=Pointer.prototype;Pointer.fn.setTarget=function(a){this.target=a};Pointer.fn.getTarget=function(){return this.target};function Composite(){if(!this instanceof Composite){return new Composite}this.childList=[]}Composite.fn=Composite.prototype;Composite.fn.addChild=function(a){this.childList.push(a)};Composite.fn.getChild=function(a){return this.childList[a]};Composite.fn.loopChild=function(a,b){return this.childList.map(a,b)};Composite.fn.addChilds=function(a){if(!(a instanceof Array)){return}a.forEach(function(b){this.addChild(this.initChild(b))},this)};Composite.fn.initChild=function(a){return a};function TierProperty(a){if(!this instanceof TierProperty){return new TierProperty(a)}this.tier=-1;this.unlockRquire=0;this.unlockRquireReduced=0;this.skillPointBasic=0;this.skillPointAce=0;this.skillCostBasic=0;this.skillCostAce=0;this.init(a)}TierProperty.fn=TierProperty.prototype;TierProperty.fn.init=function(a){for(var b in this){if(typeof a[b]!=="undefined"){this[b]=a[b]}}};TierProperty.fn.requestTierRequire=function(a){if(!a){return this.unlockRquire}else{return this.unlockRquireReduced}};TierProperty.fn.requestTierSkillPoint=function(a){switch(String(a).toLowerCase()){case"basic":return this.skillPointBasic;case"ace":return this.skillPointAce;default:throw"undefined type : "+a}};TierProperty.fn.requestTierSkillCost=function(a){switch(String(a).toLowerCase()){case"basic":return this.skillCostBasic;case"ace":return this.skillCostAce;default:throw"undefined type : "+a}};function TierDictionary(a){if(!this instanceof TierDictionary){return new TierDictionary(a)}Composite.call(this);this.index={};this.init(a)}TierDictionary.prototype=Object.create(Composite.prototype);TierDictionary.fn=TierDictionary.prototype;TierDictionary.fn.init=function(a){this.addChilds(a);this.bulidIndex()};TierDictionary.fn.initChild=function(a){return new TierProperty(a)};TierDictionary.fn.bulidIndex=function(){this.loopChild(function(a){this.setIndex(a.tier,a)},this)};TierDictionary.fn.setIndex=function(a,b){this.index[a]=b};TierDictionary.fn.getIndex=function(a){return this.index[a]};TierDictionary.fn.getTierProperty=function(a){var b=this.getIndex(a);if(!b){throw"Can't find tier index : "+a}return b};TierDictionary.fn.requestTierRequire=function(a,b){return this.getTierProperty(a).requestTierRequire(b)};TierDictionary.fn.requestTierSkillPoint=function(b,a){return this.getTierProperty(a).requestTierSkillPoint(b)};TierDictionary.fn.requestTierSkillCost=function(b,a,c){var d;d=this.getTierProperty(a).requestTierSkillCost(b);d=(c===true)?Math.round(d*0.75):d;return d};function SkillTreePrototype(a){if(!this instanceof SkillTreePrototype){return new SkillTreePrototype(a)}Composite.call(this);this._parent=a}SkillTreePrototype.prototype=Object.create(Composite.prototype);SkillTreePrototype.fn=SkillTreePrototype.prototype;SkillTreePrototype.fn.getSpendPoint=function(){var a=0;this.loopChild(function(b){a+=b.getSpendPoint()});return a};SkillTreePrototype.fn.getSpendCost=function(){var a=0;this.loopChild(function(b){a+=b.getSpendCost()});return a};SkillTreePrototype.fn.updateTierRequire=function(){this.loopChild(function(a){a.updateTierRequire()})};SkillTreePrototype.fn.updateSkillPoint=function(){this.loopChild(function(a){a.updateSkillPoint()})};SkillTreePrototype.fn.updateSkillCost=function(){this.loopChild(function(a){a.updateSkillCost()})};SkillTreePrototype.fn.requestTierRequire=function(a,b){return this._parent.requestTierRequire(a,b)};SkillTreePrototype.fn.requestTierSkillPoint=function(b,a){return this._parent.requestTierSkillPoint(b,a)};SkillTreePrototype.fn.requestTierSkillCost=function(b,a,c){return this._parent.requestTierSkillCost(b,a,c)};SkillTreePrototype.fn.callParentUpdate=function(){this._parent.callParentUpdate()};SkillTreePrototype.fn.callChildUpdateSkill=function(a){this.loopChild(function(b){b.callChildUpdateSkill(a)})};SkillTreePrototype.fn.callParentInitPointer=function(a){return this._parent.callParentInitPointer(a)};SkillTreePrototype.fn.callParentSetPointer=function(b,a){this._parent.callParentSetPointer(b,a)};SkillTreePrototype.fn.callChildBulidPointerList=function(a){this.loopChild(function(b){b.callChildBulidPointerList(a)})};function Skill(b,a){if(!this instanceof Skill){return new Skill(b,a)}this._parent=b;this.name="[undefined]";this.title="[undefined]";this.basic="[undefined]";this.ace="[undefined]";this.text="";this.ownBasic=false;this.ownAce=false;this.unlockBasic=false;this.unlockAce=false;this.require=false;this.unlockRequire=false;this.alert=false;this.init(a)}Skill.prototype=Object.create(SkillTreePrototype.prototype);Skill.fn=Skill.prototype;Skill.fn.init=function(a){if(!a){return}this.name=(typeof a.name==="string")?a.name:this.name;this.title=(typeof a.title==="string")?a.title:this.title;this.basic=(typeof a.basic==="string")?a.basic:this.basic;this.ace=(typeof a.ace==="string")?a.ace:this.ace;this.text=(typeof a.text!=="undefined")?a.text:this.text;if(typeof a.require!=="undefined"){this.initRequire(a.require)}};Skill.fn.initRequire=function(a){if(typeof a!=="string"){return}this.require=this.callParentInitPointer(a)};Skill.fn.set=function(a,b){switch(String(a).toLowerCase()){case"basic":return this.ownBasic=Boolean(b);case"ace":return this.ownAce=Boolean(b);default:throw"Undefined key : "+a}};Skill.fn.isOwned=function(a){switch(String(a).toLowerCase()){case"basic":return this.ownBasic;case"ace":return this.ownAce;default:throw"Undefined key : "+a}};Skill.fn.isUnlocked=function(a){switch(String(a).toLowerCase()){case"basic":return this.unlockBasic;case"ace":return this.unlockAce;default:throw"Undefined key : "+a}};Skill.fn.updateStatus=function(a){var b=this.updateRequireStatus();this.updateUnlockStatus(a);this.updateOwnStatus();if(b){this.callParentUpdate()}};Skill.fn.updateRequireStatus=function(){if(!(this.require instanceof Pointer)){this.unlockRequire=true;return false}var c=this.require.getTarget();if(!(c instanceof Skill)){throw"目標為空"}var a=(c.isOwned("basic"));var b=false;if(!a){this.unlockBasic=false;this.unlockAce=false;if(this.unlockRequire==true){b=true}}this.unlockRequire=a;return b};Skill.fn.updateUnlockStatus=function(a){if(this.unlockRequire===false){return}if(!this._parent.isUnlocked()){this.unlockBasic=false;this.unlockAce=false;return}this.unlockBasic=(a>=this._parent.skillPointBasic||this.isOwned("basic"));this.unlockAce=(this._parent.skillPointAce>0)?(this.isOwned("basic"))?(a>=this._parent.skillPointAce||this.ownAce):(a>=this._parent.skillPointBasic+this._parent.skillPointAce):false};Skill.fn.updateOwnStatus=function(){if(this.unlockBasic!==true){this.set("basic",false)}if(this.unlockAce!==true){this.set("ace",false)}};Skill.fn.getSpendPoint=function(){var a=0;if(this.isOwned("basic")){a+=this.requestTierSkillPoint("basic")}if(this.isOwned("ace")){a+=this.requestTierSkillPoint("ace")}return a};Skill.fn.getSpendCost=function(){var a=0;if(this.isOwned("basic")){a+=this.requestTierSkillCost("basic")}if(this.isOwned("ace")){a+=this.requestTierSkillCost("ace")}return a};Skill.fn.unlock=function(){if(!this.isOwned("basic")){if(this.isUnlocked("basic")){this.set("basic",true)}}else{if(!this.isOwned("ace")){if(this.isUnlocked("ace")){this.set("ace",true)}}}this.callParentUpdate()};Skill.fn.unset=function(){this.set("basic",false);this.set("ace",false);this.callParentUpdate()};Skill.fn.callChildUpdateSkill=function(a){this.updateStatus(a)};Skill.fn.callChildBulidPointerList=function(b){var a=this.name;if(b.indexOf(a)>=0){this.callParentSetPointer(a,this)}};function Tier(b,a){if(!this instanceof Tier){return new Tier(b,a)}SkillTreePrototype.call(this,b);this.tier=-1;this.unlockRequire=0;this.skillPointBasic=0;this.skillPointAce=0;this.skillCostBasic=0;this.skillCostAce=0;this.unlockNeeded=0;this.unlockStatus=false;this.init(a)}Tier.prototype=Object.create(SkillTreePrototype.prototype);Tier.fn=Tier.prototype;Tier.fn.init=function(a){if(!a){return}this.tier=(typeof a.tier==="number")?a.tier:this.tier;if(typeof a.skills!=="undefined"){this.addChilds(a.skills)}this.initProperty()};Tier.fn.initChild=function(a){return new Skill(this,a)};Tier.fn.initProperty=function(){this.updateTierRequire();this.updateSkillPoint();this.updateSkillCost()};Tier.fn.updateStatus=function(a){this.updateUnlockStatus(a);if(!this.unlockStatus){return 0}return this.getSpendPoint()};Tier.fn.updateUnlockStatus=function(a){this.unlockNeeded=this.unlockRequire-a;this.unlockStatus=(this.unlockNeeded<=0)};Tier.fn.isUnlocked=function(){return this.unlockStatus};Tier.fn.updateTierRequire=function(){this.unlockRequire=this.requestTierRequire()};Tier.fn.updateSkillPoint=function(){this.skillPointBasic=this.requestTierSkillPoint("basic");this.skillPointAce=this.requestTierSkillPoint("ace")};Tier.fn.updateSkillCost=function(){this.skillCostBasic=this.requestTierSkillCost("basic");this.skillCostAce=this.requestTierSkillCost("ace")};Tier.fn.callChildsUpdateTree=function(a){return this.updateStatus(a)};Tier.fn.callChildsUpdateCost=function(){return this.getCost()};Tier.fn.requestTierRequire=function(a,b){return this._parent.requestTierRequire(this.tier,b)};Tier.fn.requestTierSkillPoint=function(b,a){return this._parent.requestTierSkillPoint(b,this.tier)};Tier.fn.requestTierSkillCost=function(b,a,c){return this._parent.requestTierSkillCost(b,this.tier,c)};function Tree(b,a){if(!this instanceof Tree){return new Tree(b,a)}SkillTreePrototype.call(this,b);this.name="";this.title="";this.text="";this.spendPoint=0;this.spendCost=0;this.infamy=false;this.init(a)}Tree.prototype=Object.create(SkillTreePrototype.prototype);Tree.fn=Tree.prototype;Tree.fn.init=function(a){if(!a){return}this.name=(typeof a.name==="string")?a.name:this.name;this.title=(typeof a.title==="string")?a.title:this.title;this.text=(typeof a.text==="string")?a.text:this.text;if(typeof a.tiers!=="undefined"){this.addChilds(a.tiers)}};Tree.fn.initChild=function(a){return new Tier(this,a)};Tree.fn.setInfamy=function(a){if(typeof a!=="boolean"){return}if(this.infamy===a){return}this.infamy=a;this.updateTierRequire();this.callParentUpdate()};Tree.fn.unset=function(a){this.getChild(0).getChild(0).unset()};Tree.fn.updateStatus=function(){this.updateSpendPoint()};Tree.fn.updateSpendPoint=function(){var a=0;this.loopChild(function(b){a+=b.updateStatus(a)});this.spendPoint=a};Tree.fn.updateSpendCost=function(){this.spendCost=this.$getSpendCost()};Tree.fn.getSpendPoint=function(a){if(a===true){this.updateSpendPoint()}return this.spendPoint};Tree.fn.$getSpendCost=Tree.fn.getSpendCost;Tree.fn.getSpendCost=function(a){if(a===true){this.updateSpendCost()}return this.spendCost};Tree.fn.requestTierRequire=function(a,b){return this._parent.requestTierRequire(a,this.infamy)};Tree.fn.callParentUpdate=function(){this._parent.callParentUpdate(this)};Tree.fn.save=function(e){var a=[];var d=0;this.loopChild(function(f){f.loopChild(function(g){if(g.ownBasic){var h=d+97;if(g.ownAce){h-=32}a.push(String.fromCharCode(h))}++d})});var c=this.name.charAt(0).toLowerCase();var b=a.join("");e.set(c,b)};Tree.fn.load=function(e){var d=this.name.charAt(0).toLowerCase();if(!e.isset(d)){return}var b=e.get(d);var a=b.split("");a=a.map(function(f){return f.charCodeAt(0)});var c=0;this.loopChild(function(f){f.loopChild(function(g){var i=c+65;var h=i+32;if(a.indexOf(i)>=0){g.ownAce=true;g.ownBasic=true}else{if(a.indexOf(h)>=0){g.ownBasic=true}}c++})})};function SkillsCalculator(a,b){if(!this instanceof SkillsCalculator){return new SkillsCalculator(a,b)}SkillTreePrototype.call(this);this._tierDictionary=null;this.pointerList={};this.totalPoint=120;this.spendPoint=0;this.costReduced=true;this.spendCost=0;this.init(a,b)}SkillsCalculator.prototype=Object.create(SkillTreePrototype.prototype);SkillsCalculator.fn=SkillsCalculator.prototype;SkillsCalculator.fn.init=function(a,b){if(typeof a==="undefined"){return}this.initTierDictionary(b);this.addChilds(a);this.bulidPointerList();this.updateStatus()};SkillsCalculator.fn.initChild=function(a){return new Tree(this,a)};SkillsCalculator.fn.initTierDictionary=function(a){this._tierDictionary=new TierDictionary(a)};SkillsCalculator.fn.setInfamy=function(a){this.loopChild(function(b,c){b.setInfamy(a[c]||false)})};SkillsCalculator.fn.costReduce=function(a){if(typeof a==="boolean"){this.costReduced=a;this.updateSkillCost();this.updateTreeSpendCost();this.updateSpendCost()}return this.costReduced};SkillsCalculator.fn.getAvailablePoint=function(){return this.totalPoint-this.spendPoint};SkillsCalculator.fn.unset=function(){this.loopChild(function(a){a.unset()})};SkillsCalculator.fn.updateStatus=function(){this.updateTreeStatus();this.updateSpendPoint();this.callChildUpdateSkill(this.getAvailablePoint());this.updateTreeSpendCost();this.updateSpendCost()};SkillsCalculator.fn.updateTreeStatus=function(){this.loopChild(function(a){a.updateStatus()})};SkillsCalculator.fn.updateTreeSpendCost=function(){this.loopChild(function(a){a.updateSpendCost()})};SkillsCalculator.fn.updateSpendPoint=function(){this.spendPoint=this.$getSpendPoint()};SkillsCalculator.fn.updateSpendCost=function(a){this.spendCost=this.$getSpendCost()};SkillsCalculator.fn.$getSpendPoint=SkillsCalculator.fn.getSpendPoint;SkillsCalculator.fn.getSpendPoint=function(a){if(a===true){this.updateSpendPoint()}return this.spendPoint};SkillsCalculator.fn.$getSpendCost=SkillsCalculator.fn.getSpendCost;SkillsCalculator.fn.getSpendCost=function(a){if(a===true){this.updateSpendCost()}return this.spendCost};SkillsCalculator.fn.initPointer=function(a){if(typeof this.pointerList[a]==="undefined"){this.pointerList[a]=new Pointer}return this.pointerList[a]};SkillsCalculator.fn.setPointer=function(b,a){if(typeof this.pointerList[b]==="undefined"){throw"未定義指標: "+b}this.pointerList[b].setTarget(a)};SkillsCalculator.fn.bulidPointerList=function(){var b=[];for(var a in this.pointerList){b.push(a)}this.callChildBulidPointerList(b)};SkillsCalculator.fn.callParentUpdate=function(a){a.updateStatus();this.updateSpendPoint();this.callChildUpdateSkill(this.getAvailablePoint());a.updateSpendCost();this.updateSpendCost()};SkillsCalculator.fn.callChildsUpdateTree=function(){this.loopChild(function(a){a.callChildsUpdateTree()})};SkillsCalculator.fn.callChildsUpdateCost=function(){this.loopChild(function(a){a.callChildsUpdateCost()})};SkillsCalculator.fn.callParentInitPointer=function(a){return this.initPointer(a)};SkillsCalculator.fn.callParentSetPointer=function(b,a){this.setPointer(b,a)};SkillsCalculator.fn.requestTierRequire=function(a,b){return this._tierDictionary.requestTierRequire(a,b)};SkillsCalculator.fn.requestTierSkillPoint=function(b,a){return this._tierDictionary.requestTierSkillPoint(b,a)};SkillsCalculator.fn.requestTierSkillCost=function(b,a,c){return this._tierDictionary.requestTierSkillCost(b,a,this.costReduce())};SkillsCalculator.fn.setStorage=function(a){this._storage=a};SkillsCalculator.fn.save=function(a){this.loopChild(function(b){b.save(a)})};SkillsCalculator.fn.load=function(a){this.loopChild(function(b){b.load(a)});this.updateStatus(true)};function PerkDecksPrototype(a){throw"此為抽象類別"}PerkDecksPrototype.prototype=Object.create(Composite.prototype);PerkDecksPrototype.fn=PerkDecksPrototype.prototype;PerkDecksPrototype.fn.callParentSet=function(a){this._parent.callParentSet(a)};function Deck(a){if(!this instanceof Deck){return new Deck(a)}this._parent=a;this.deck=-1;this.name="[undefined]";this.title="[undefined]";this.text=[];this.owned=false}Deck.prototype=Object.create(PerkDecksPrototype.prototype);Deck.fn=Deck.prototype;Deck.fn.init=function(a){this.deck=(typeof a.deck==="number")?a.deck:this.deck;this.name=(typeof a.name==="string")?a.name:this.name;this.title=(typeof a.title==="string")?a.title:this.title;this.text=(typeof a.text!=="undefined")?this.initText(a.text):this.text};Deck.fn.initText=function(a){if(!(a instanceof Array)){return[]}return a.map(function(b){if(typeof b==="string"){return b}})};Deck.fn.set=function(){this.owned=true};Deck.fn.unset=function(){this.owned=false};Deck.fn.isset=function(){return this.owned};Deck.fn.choice=function(){this.callParentSet(this)};function Perk(a){if(!this instanceof Perk){return new Perk(a)}this._parent=a;this.childList=[];this.code="[undefined]";this.name="[undefined]";this.title="[undefined]";this.rank=-1;this.equipped=false}Perk.prototype=Object.create(PerkDecksPrototype.prototype);Perk.fn=Perk.prototype;Perk.fn.init=function(a){this.code=(typeof a.code==="string")?a.code:this.code;this.name=(typeof a.name==="string")?a.name:this.name;this.title=(typeof a.title==="string")?a.title:this.title;if(typeof a.decks!=="undefined"){this.addChilds(a.decks)}};Perk.fn.initChild=function(a){var b=new Deck(this);b.init(a);return b};Perk.fn.set=function(){this.equipped=true};Perk.fn.unset=function(){this.equipped=false};Perk.fn.isset=function(){return this.equipped};Perk.fn.setRank=function(a){this.rank=a;this.updateDeckStatus()};Perk.fn.getRank=function(){return this.rank};Perk.fn.updateStatus=function(){var a=-1;for(var b=this.childList.length-1;b>=0;b--){if(a<0){if(this.childList[b].isset()===true){a=b}}else{this.childList[b].set()}}this.rank=a};Perk.fn.clear=function(){this.loopChild(function(a){a.unset()})};Perk.fn.callParentSet=function(a){this._parent.callParentSet(this);a.set();this.updateStatus()};Perk.fn.updateDeckStatus=function(){var a=this.rank;for(var b=0;b<this.childList.length;b++){if(b>a){this.childList[b].unset()}else{this.childList[b].set()}}};function PerkDecksCalculator(a){if(!this instanceof PerkDecksCalculator){return new PerkDecksCalculator(a)}this.childList=[];this.init(a);this.equipped=-1}PerkDecksCalculator.prototype=Object.create(PerkDecksPrototype.prototype);PerkDecksCalculator.fn=PerkDecksCalculator.prototype;PerkDecksCalculator.fn.init=function(a){if(typeof a==="undefined"){return}this.addChilds(a)};PerkDecksCalculator.fn.initChild=function(a){var b=new Perk(this);b.init(a);return b};PerkDecksCalculator.fn.updateStatus=function(){this.loopChild(function(b,a){if(b.isset()){this.equipped=a}},this)};PerkDecksCalculator.fn.getEquippedPerk=function(){if(this.equipped==-1){return null}if(typeof this.childList[this.equipped]==="undefined"){return null}return this.childList[this.equipped]};PerkDecksCalculator.fn.clear=function(){this.loopChild(function(a){a.clear();a.unset()})};PerkDecksCalculator.fn.save=function(f){var e="p";var a="";var c=this.getEquippedPerk();if(c){var b=c.code.toUpperCase();var d=c.getRank();a=b+d}f.set(e,a)};PerkDecksCalculator.fn.load=function(e){var d="p";if(e.isset(d)){var b=e.get(d);var a=b.match(/([a-zA-Z]\d*)/g);var c={};a.forEach(function(h){var f=h.charAt(0);var g=h.slice(1);c[f]=g});this.loopChild(function(h){var g=h.code.toUpperCase();if(typeof c[g]==="undefined"){return}var f=c[g];h.set();h.setRank(f)})}this.updateStatus()};PerkDecksCalculator.fn.callParentSet=function(a){this.clear();a.set();this.updateStatus()};function InfamyPrototype(){if(!this instanceof InfamyPrototype){return new InfamyPrototype}Composite.call(this)}InfamyPrototype.prototype=Object.create(Composite.prototype);InfamyPrototype.fn=InfamyPrototype.prototype;InfamyPrototype.fn.callParentUpdate=function(){};InfamyPrototype.fn.callChildsUpdateUsedPoint=function(){};InfamyPrototype.fn.callChildsUpdateStatus=function(){};function Infamy(a){if(!this instanceof Infamy){return new Infamy(a)}this._parent=a;this.name="";this.title="";this.text="";this.bonuses=[];this.owned=false;this.unlock=false}Infamy.prototype=Object.create(InfamyPrototype.prototype);Infamy.fn=Infamy.prototype;Infamy.fn.init=function(a){this.name=(typeof a.name==="string")?a.name:this.name;this.title=(typeof a.title==="string")?a.title:this.title;this.text=(typeof a.text==="string")?a.text:this.text;this.bonuses=(a.bonuses instanceof Array)?a.bonuses:this.bonuses};Infamy.fn.set=function(a){if(typeof a!=="boolean"){return}if(this.owned===a){return}if(a===true&&this.unlock!==true){return}this.owned=a;this.callParentUpdate()};Infamy.fn.updateStatus=function(a){this.updateUnlockStatus(a);this.updateOwnStatus()};Infamy.fn.updateUnlockStatus=function(a){if(this._parent.unlockStatus===true){this.unlock=(a>=1||this.owned)}else{this.unlock=false}};Infamy.fn.updateOwnStatus=function(){if(this.unlock!==true){this.owned=false}};Infamy.fn.callParentUpdate=function(){return this._parent.callParentUpdate()};Infamy.fn.callChildsUpdateStatus=function(a){this.updateStatus(a)};function InfamyTier(a){if(!this instanceof InfamyTier){return new InfamyTier(a)}InfamyPrototype.call(this);this._parent=a;this.childList=[];this.tier=-1;this.unlockRequire=0;this.toUnlock=0;this.unlockStatus=false}InfamyTier.prototype=Object.create(InfamyPrototype.prototype);InfamyTier.fn=InfamyTier.prototype;InfamyTier.fn.init=function(a){if(typeof a.talents!=="undefined"){this.addChilds(a.talents)}this.tier=(typeof a.tier==="number")?a.tier:this.tier;this.unlockRequire=(typeof a.unlockRequire==="number")?a.unlockRequire:this.unlockRequire};InfamyTier.fn.addChilds=function(b){if(!(b instanceof Array)){return}var a=this;b.forEach(function(c){a.initChild(c)})};InfamyTier.fn.initChild=function(a){var b=new Infamy(this);b.init(a);this.addChild(b)};InfamyTier.fn.updateStatus=function(a){this.toUnlock=this.unlockRequire-a;this.unlockStatus=(this.toUnlock<=0);if(this.unlockStatus===true){this.loopChild(function(b){if(b.owned===true){a+=1}})}return a};InfamyTier.fn.callParentUpdate=function(){return this._parent.callParentUpdate(this.tier)};InfamyTier.fn.callChildsUpdateUsedPoint=function(a){return this.updateStatus(a)};InfamyTier.fn.callChildsUpdateStatus=function(a){this.loopChild(function(b){b.callChildsUpdateStatus(a)})};function InfamyCalculator(a){if(!this instanceof InfamyCalculator){return new InfamyCalculator(a)}InfamyPrototype.call(this);this._skillsCalculator=null;this.totalPoint=5;this.usedPoint=0;this.init(a)}InfamyCalculator.prototype=Object.create(InfamyPrototype.prototype);InfamyCalculator.fn=InfamyCalculator.prototype;InfamyCalculator.fn.init=function(a){if(typeof a==="undefined"){return}if(typeof a.tiers!=="undefined"){this.addChilds(a.tiers)}};InfamyCalculator.fn.initChild=function(a){var b=new InfamyTier(this);b.init(a);return b};InfamyCalculator.fn.updateStatus=function(){this.usedPoint=this.callChildsUpdateUsedPoint();this.callChildsUpdateStatus(this.getAvailablePoint());this.updateSkillsCalculator()};InfamyCalculator.fn.getAvailablePoint=function(){return this.totalPoint-this.usedPoint};InfamyCalculator.fn.setSkillsCalculator=function(a){if(!(a instanceof SkillsCalculator)){return}this._skillsCalculator=a};InfamyCalculator.fn.updateSkillsCalculator=function(){if(!this._skillsCalculator){return}var a=this.getInfamyStatus();this._skillsCalculator.setInfamy(a);this._skillsCalculator.costReduce(this.isCostReduce())};InfamyCalculator.fn.getInfamyStatus=function(){var a=this.getChild(1);var c=a.loopChild(function(d){return d.owned});var b=false;c.forEach(function(d){b=(b||d)});c.push(b);return c};InfamyCalculator.fn.isCostReduce=function(){return this.getChild(0).getChild(0).owned};InfamyCalculator.fn.save=function(e){var a=[];var d=0;this.loopChild(function(f){f.loopChild(function(g){if(g.owned===true){var h=d+97;a.push(String.fromCharCode(h))}++d})});var c="i";var b=a.join("");e.set(c,b)};InfamyCalculator.fn.load=function(e){var d="i";if(e.isset(d)){var b=e.get(d);var a=b.split("");a=a.map(function(f){return f.charCodeAt(0)});var c=0;this.loopChild(function(f){f.loopChild(function(g){var h=c+97;if(a.indexOf(h)>=0){g.owned=true}++c})})}this.updateStatus()};InfamyCalculator.fn.callParentUpdate=function(a){this.updateStatus()};InfamyCalculator.fn.callChildsUpdateUsedPoint=function(){var a=0;this.loopChild(function(b){a=b.updateStatus(a)});return a};InfamyCalculator.fn.callChildsUpdateStatus=function(a){this.loopChild(function(b){b.callChildsUpdateStatus(a)})};function Storage(){if(!this instanceof Storage){return new Storage(parent)}this._container={}}Storage.fn=Storage.prototype;Storage.fn.set=function(a,b){this._container[a]=b};Storage.fn.get=function(a){return this._container[a]};Storage.fn.clear=function(){this._container={}};Storage.fn.count=function(){return Object.keys(this._container).length};Storage.fn.isset=function(a){return(!(typeof this._container[a]==="undefined"))};Storage.fn.unset=function(a){return delete this._container[a]};function HashStorage(a){if(!this instanceof HashStorage){return new HashStorage(a)}Storage.call(this);this._location=a;this.load()}HashStorage.prototype=Object.create(Storage.prototype);HashStorage.fn=HashStorage.prototype;HashStorage.fn.save=function(){var a=[];Object.keys(this._container).forEach(function(d){var c=this.get(d);if(c){a.push(d+c)}},this);var b=a.join(":");this._location.path(b)};HashStorage.fn.load=function(){this.clear();var b=this._location.path().replace(/^(.)*\//g,"");var a=b.split(":");a.forEach(function(c){if(c==""){return}var e=c.charAt(0);var d=c.slice(1);this.$set(e,d)},this)};HashStorage.fn.$set=HashStorage.fn.set;HashStorage.fn.set=function(a,b){this.$set(a,b);this.save()};HashStorage.fn.$get=HashStorage.fn.get;HashStorage.fn.get=function(a){return this.$get(a)};